<html dir="LTR">
  <head>
    <meta charset="utf-8" />
    <meta name="vs_targetSchema" content="http://schemas.microsoft.com/intellisense/ie5" />
    <title>ICogAcqFifo.CompleteAcquire Method</title>
    <xml />
    <link rel="stylesheet" type="text/css" href="MSDN.css" />
  </head>
  <body id="bodyID" class="dtBODY">
    <div id="nsbanner">
      <div id="bannerrow1">
        <table class="bannerparthead" cellspacing="0">
          <tr id="hdr">
            <td class="runninghead">VisionPro Programming Reference</td>
            <td class="product" />
          </tr>
        </table>
      </div>
      <div id="TitleRow">
        <h1 class="dtH1">ICogAcqFifo.CompleteAcquire Method </h1>
      </div>
    </div>
    <div id="nstext">
      <p>Completes the acquisition specified by the given ticket and returns the acquired image. If the ticket is omitted, or set to -1, the uncompleted acquire that was least recently started will be completed.</p>
      <div class="syntax">
        <a href="Cognex.VisionPro.ICogImage.html">ICogImage</a> CompleteAcquire(<br />   <a href="ms-help://MS.VSCC.v80/MS.MSDN.v80/MS.NETDEVFX.v20.en/cpref2/html/T_System_Int32.htm">Int32</a> <i>requestedTicket</i>,<br />   out <a href="ms-help://MS.VSCC.v80/MS.MSDN.v80/MS.NETDEVFX.v20.en/cpref2/html/T_System_Int32.htm">Int32&amp;</a> <i>ticket</i>,<br />   out <a href="ms-help://MS.VSCC.v80/MS.MSDN.v80/MS.NETDEVFX.v20.en/cpref2/html/T_System_Int32.htm">Int32&amp;</a> <i>triggerNumber</i><br />);</div>
      <h4 class="dtH4">Parameters</h4>
      <dl>
        <dt>
          <i>requestedTicket</i>
        </dt>
        <dd>
          <p>The ticket of an outstanding acquisition. This is usually a value returned by <a href="Cognex.VisionPro.ICogAcqFifo.StartAcquire.html">StartAcquire</a>. If this value is omitted or set to -1, the oldest outstanding acquisition is completed. <i>requestedTicket</i> must be -1 for automatically triggered acquisitions.</p>
        </dd>
        <dt>
          <i>ticket</i>
        </dt>
        <dd>
          <p>The actual ticket of the completed acquisition. When <i>requestedTicket</i> is not -1, this value is the same as <i>requestedTicket</i>.</p>
        </dd>
        <dt>
          <i>triggerNumber</i>
        </dt>
        <dd>
          <p>The trigger sequence number of the completed acquisition. You can compare this value with <i>Trigger</i> value returned by <a href="Cognex.VisionPro.ICogAcqFifo.Acquire.html">Acquire</a> to see if there were missed triggers.</p>
        </dd>
      </dl>
      <h4 class="dtH4">Return Value</h4>
      <p>
        <p>The acquired <a href="Cognex.VisionPro.ICogImage.html">image</a>.</p>
      </p>
      <h4 class="dtH4">Remarks</h4>
      <p>
        <p>Completes the acquisition specified by the given ticket and returns the acquired image. If <i>ticket</i> is omitted, or set to -1, the oldest outstanding acquisition will be completed.</p>
        <blockquote class="dtBlock">
          <b>Note</b>    If you are completing an automatically triggered acquisition (one for which <a href="Cognex.VisionPro.ICogAcqFifo.StartAcquire.html">StartAcquire</a> was not called), then you must either omit the <i>requestedTicket</i> argument or supply a value of -1. </blockquote>
        <p> Under some conditions, the VisionPro acquisition system may fire a <a href="Cognex.VisionPro.ICogAcqFifo.Complete.html">Complete</a> event when there is no completed acquisition available. If you call <b>CompleteAcquire</b> when this happens, you will receive a timeout error, or possibly some other error. This happens primarily when you disable triggers and <a href="Cognex.VisionPro.ICogAcqFifo.Flush.html">Flush</a> the FIFO (to stop acquisitions), and the <b>Complete</b> event for the flushed image fires. To avoid this situation, be sure to call <a href="Cognex.VisionPro.ICogAcqFifo.GetFifoState.html">GetFifoState</a>, to determine whether there really is an image pending. </p>
        <p>
          <b>CompleteAcquire</b> can fire <b>Complete</b>, <a href="Cognex.VisionPro.ICogAcqFifo.MovePart.html">MovePart</a>, and <a href="Cognex.VisionPro.ICogAcqFifo.Overrun.html">Overrun</a>. </p>
      </p>
      <h4 class="dtH4">Exceptions</h4>
      <div class="tablediv">
        <table class="dtTABLE" cellspacing="0">
          <tr valign="top">
            <th width="50%">Exception Type</th>
            <th width="50%">Condition</th>
          </tr>
          <tr valign="top">
            <td width="50%">
              <a href="Cognex.VisionPro.Exceptions.CogAcqTimeoutException.html">CogAcqTimeoutException</a>
            </td>
            <td width="50%">
              <p>
                <a href="Cognex.VisionPro.ICogAcqFifo.Timeout.html">Timeout</a> period expired.</p>
            </td>
          </tr>
          <tr valign="top">
            <td width="50%">
              <a href="Cognex.VisionPro.Exceptions.CogAcqBadTicketException.html">CogAcqBadTicketException</a>
            </td>
            <td width="50%">
              <p>
                <i>ticket</i> is -1 and there is no outstanding <a href="Cognex.VisionPro.ICogAcqFifo.StartAcquire.html">StartAcquire</a>, or if there is no <b>StartAcquire</b> for this <i>ticket</i>.</p>
            </td>
          </tr>
          <tr valign="top">
            <td width="50%">
              <a href="Cognex.VisionPro.Exceptions.CogAcqOldTicketException.html">CogAcqOldTicketException</a>
            </td>
            <td width="50%">
              <p>The image corresponding to <i>ticket</i> has already been collected.</p>
            </td>
          </tr>
          <tr valign="top">
            <td width="50%">
              <a href="Cognex.VisionPro.Exceptions.CogAcqOverrunException.html">CogAcqOverrunException</a>
            </td>
            <td width="50%">
              <p>A trigger could not be serviced.</p>
            </td>
          </tr>
          <tr valign="top">
            <td width="50%">
              <a href="Cognex.VisionPro.Exceptions.CogAcqAbnormalException.html">CogAcqAbnormalException</a>
            </td>
            <td width="50%">
              <p>The acquisition failed because of a fault in the acquisition hardware or because of some other unusual problem.</p>
            </td>
          </tr>
          <tr valign="top">
            <td width="50%">
              <a href="Cognex.VisionPro.Exceptions.CogAcqEncoderOverrunException.html">CogAcqEncoderOverrunException</a>
            </td>
            <td width="50%">
              <p>Encoder overrun.</p>
            </td>
          </tr>
          <tr valign="top">
            <td width="50%">
              <a href="Cognex.VisionPro.Exceptions.CogAcqInvalidROIException.html">CogAcqInvalidROIException</a>
            </td>
            <td width="50%">
              <p>The <a href="Cognex.VisionPro.ICogAcqROI.html">region of interest</a> is not valid.</p>
            </td>
          </tr>
          <tr valign="top">
            <td width="50%">
              <a href="Cognex.VisionPro.Exceptions.CogAcqNoOutstandingStartsException.html">CogAcqNoOutstandingStartsException</a>
            </td>
            <td width="50%">
              <p>
                <i>ticket</i> was -1, but there were no outstanding <a href="Cognex.VisionPro.ICogAcqFifo.StartAcquire.html">StartAcquire</a> requests</p>
            </td>
          </tr>
          <tr valign="top">
            <td width="50%">
              <a href="Cognex.VisionPro.Exceptions.CogAcqOtherFifoErrorException.html">CogAcqOtherFifoErrorException</a>
            </td>
            <td width="50%">
              <p>There was an error in another FIFO in the same master/slave group.</p>
            </td>
          </tr>
        </table>
      </div>
      <h4 class="dtH4">Example</h4>
      <p>
        <pre class="code">
          <span class="lang">[C#]
</span>using Cognex.VisionPro;

private CogFrameGrabbers myFrameGrabbers;
private ICogFrameGrabber myFrameGrabber;
private ICogAcqFifo myAcqFifo;

        private void AcquireDisplay () {
            const string VIDEO_FORMAT = "Sony XC75 640x480";
            int    acqTicket, completeTicket, triggerNumber, numPending, numReady;
            bool busy;

            myFrameGrabbers = new CogFrameGrabbers();
            myFrameGrabber = myFrameGrabbers[0];
            myAcqFifo = myFrameGrabber.CreateAcqFifo(VIDEO_FORMAT, Cognex.VisionPro.CogAcqFifoPixelFormatConstants.Format8Grey, 0, false);

            acqTicket = myAcqFifo.StartAcquire();

            do {
                myAcqFifo.GetFifoState(out numPending, out numReady, out busy);

                if (numReady &gt; 0)
                    cogDisplay1.Image = myAcqFifo.CompleteAcquire(acqTicket, out completeTicket, out triggerNumber);
            } while (numReady &lt;= 0);
        }
</pre>
        <pre class="code">
          <span class="lang">[Visual Basic]
</span>Imports Cognex.VisionPro

Private myFrameGrabbers As CogFrameGrabbers
Private myFrameGrabber As Cognex.VisionPro.ICogFrameGrabber
Private myAcqFifo As Cognex.VisionPro.ICogAcqFifo

Private Sub AcquireDisplay()
    Const VIDEO_FORMAT = "Sony XC75 640x480"
    Dim acqTicket As Integer
    Dim numPending As Integer : Dim numReady As Integer : Dim busy As Boolean
    Dim completeTicket As Integer : Dim triggerNum As Integer

    myFrameGrabbers = New CogFrameGrabbers
    myFrameGrabber = myFrameGrabbers.Item(0)
    myAcqFifo = myFrameGrabber.CreateAcqFifo(VIDEO_FORMAT, CogAcqFifoPixelFormatConstants.Format8Grey, 0, False)

    acqTicket = myAcqFifo.StartAcquire()
    Do
        myAcqFifo.GetFifoState(numPending, numReady, busy)
    Loop Until numReady &gt; 0

    CogDisplay1.Image = myAcqFifo.CompleteAcquire(acqTicket, completeTicket, triggerNum)
End Sub
</pre>
      </p>
      <h4 class="dtH4">See Also</h4>
      <p>
        <a href="Cognex.VisionPro.ICogAcqFifo.html">ICogAcqFifo Interface</a> | <a href="Cognex.VisionPro.html">Cognex.VisionPro Namespace</a></p>

      <hr />
      <div id="footer">
        <p>
          <a href="mailto:pb@cognex.com?subject=VisionPro%20Programming%20Reference%20Documentation%20Feedback:%20ICogAcqFifo.CompleteAcquire Method ">Comment on this page.</a>
        </p>
        <p>
          <a href="copyright.html">Copyright © 2008 Cognex Corporation</a>
        </p>
        <p>
        </p>
      </div>
    </div>
  </body>
</html>
