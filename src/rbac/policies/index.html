<!DOCTYPE html>
<html lang="en">
<head>

  <title>Working with Policies</title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <link href="/assets/styles/styles.css"    rel="stylesheet" type="text/css"  />
  <link href="/assets/styles/docstyles.css" rel="stylesheet" type="text/css" />
  <link href="/assets/styles/prettify.css"  rel="stylesheet" type="text/css" />
  <script src="/assets/js/prettify.js" type="text/javascript"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js" type="text/javascript"></script>


    <script type="text/javascript">
      $(document).ready(function() {
          $('pre').each(function() {
              var thepre = $(this);
              if (thepre.hasClass('javascript') ||
                  thepre.hasClass('js') ||
                  thepre.hasClass('shell') ||
                  thepre.hasClass('bash')
                 )
                thepre.addClass('prettyprint');
          });
          prettyPrint();
      });
    </script>



</head>

<body>

  <div id="header">
      <div style="margin: 10px 10px">
        <p>
          Philip Borenstein: Writing sample <br/>
          This is a snapshot of this topic when I wrote it.<br/>
          You can find the current version in the
          <a href="http://docs.joyent.com">Joyent documentation.</p>
        </p>
      </div>
  </div>
  <div id="sidebar">
    <div class="menu">
      <form id="search" action="/search"><input type="search" name="q" placeholder="Search..."></form>

<ul>



	<li class="depth-1">

	<a href="/rbac">Role Based Access Control</a>


<ul>



	<li class="depth-2 hasChildren">

	<a href="/rbac/quickstart">Getting Started with Access Control: CLI</a>


	</li>


	<li class="depth-2">

	<a href="/rbac/portal">Getting Started with Access Control: Portal</a>


	</li>


	<li class="depth-2">

	<a href="/rbac/cloudapi">Using Access Control with CloudAPI</a>


	</li>


	<li class="depth-2">

	<a href="/rbac/users">Working with Users</a>


	</li>


	<li class="depth-2">

	<a href="/rbac/roles">Working with Roles</a>


	</li>


	<li class="depth-2">

	<a class="active" href="/rbac/policies">Working with Policies</a>


<ul>



</ul>

	</li>


	<li class="depth-2">

	<a href="/rbac/rules">Working with Rules</a>


	</li>


	<li class="depth-2">

	<a href="/rbac/underthehood">Under the Hood</a>


	</li>


</ul>

	</li>


</ul>
    </div>
        <div class="footblock">
    <p>Â© 2015 <a href="http://joyent.com">Joyent, Inc.</a> | <a href="mailto:&#x73;&#x75;&#x70;&#x70;&#x6f;&#x72;&#116;&#x40;&#106;&#111;&#121;&#101;&#110;&#116;&#46;&#99;&#111;&#109;">Questions, comments, feeback.</a></p></div>
  </div>
<div id="content" class="content">
    <nav class="breadcrumb">
	<ul>
					<li><a href="/">Home &rsaquo;</a></li>
					<li><a href="/rbac">Role Based Access Control &rsaquo;</a></li>
			</ul>
</nav>    <h1>Working with Policies</h1>
    <div class="infoblock">
                
    <div class="stability_3 stability">
        Stability: <a href="/stability">Stable</a>
    </div>
    </div>
    <p>Policies are lists of rules that describe access to resources.
The rules are written in a human readable language
that describes the action that is allowed
and the context in which that rule is valid.</p>
<p>The default policy for all objects is to deny access always.
Rules are written in terms of what is allowed.
For example, the following rules say that
getting a Manta object and listing a Manta directory is allowed:</p>
<pre><code>CAN getobject
CAN getdirectory</code></pre>
<p>All of the CLI commands involving policies are
subcommands of the <code>sdc-policy</code> command.</p>
<pre><code>$ sdc-policy help
SmartDC Account Policies

Usage:
    sdc-policy [OPTIONS] COMMAND [ARGS...]
    sdc-policy help COMMAND

Options:
    -h, -?, --help         Print help and exit.
    --version              Print version and exit.
    -d, --debug            enable debug/verbose mode (default: disabled)
    -a ARG, --account=ARG  account name. Environment: SDC_ACCOUNT=ARG
    -A ARG, --user=ARG     account sub-user login. Environment: SDC_USER=ARG
    -u ARG, --url=ARG      url for SmartDataCenter API. Environment: SDC_URL=ARG
    -k ARG, --keyId=ARG    your ssh key fingerprint. Environment: SDC_KEY_ID=ARG

Commands:
    help (?)        Help on a specific sub-command.
    list            List your Account Policies.
    get             Get an account Policy by id.
    create          Creates a new Policy for your account.
    update          Updates a Policy of your account.
    delete          Removes a Policy from your account.</code></pre>
<h2>Creating Policies</h2>
<p>Use <code>sdc-policy create</code> to create a policy.
A policy must have a name and at least one rule.</p>
<pre><code>$ sdc-policy create --name=read-access --rules='CAN getobject' --rules='CAN getdirectory'
{
  "name": "read-access",
  "id": "1ec51dfd-1197-41ef-ac7d-c90dd478ae32",
  "rules": [
    "CAN getobject",
    "CAN getdirectory"
  ]
}</code></pre>
<h2>Getting Information about Policies</h2>
<p>Use <code>sdc-policy list</code> to get all the policies in your account.</p>
<pre><code>$ sdc-policy list
[
  {
    "name": "read",
    "id": "3072e003-34f7-c4a5-9f73-a8808de40e26",
    "rules": [
      "CAN getobject"
    ]
  },
  {
    "name": "list",
    "id": "616b8f9b-9260-e34d-fcbf-f6dba02a6512",
    "rules": [
      "CAN getdirectory"
    ]
  },
. . .
]</code></pre>
<p>If you've installed
<a href="https://www.npmjs.org/package/json">json</a>,
you can use this for a quick list
of all your policies' names and <code>id</code>s.</p>
<pre><code>$ sdc-policy list | json -a name id
read 3072e003-34f7-c4a5-9f73-a8808de40e26
list 616b8f9b-9260-e34d-fcbf-f6dba02a6512
read-plus f203d7e2-56aa-cf4b-8b32-8713cfa4388d
read-access 1ec51dfd-1197-41ef-ac7d-c90dd478ae32</code></pre>
<p>Use <code>sdc-policy get</code> to get information
about a specific policy
by <code>id</code>.</p>
<pre><code>$ sdc-policy get 1ec51dfd-1197-41ef-ac7d-c90dd478ae32
{
  "name": "read-access",
  "id": "1ec51dfd-1197-41ef-ac7d-c90dd478ae32",
  "rules": [
    "CAN getdirectory",
    "CAN getobject"
  ]
}</code></pre>
<h2>Changing Policy Information</h2>
<p>Use <code>sdc-policy update</code> to change the name, description, rules of a policy.</p>
<p>When you update the rules, keep in mind that
the rules you specify replace <em>all</em> the rules
that the policy had initially.</p>
<pre><code>$ sdc-policy update --rules='CAN getobject' 1ec51dfd-1197-41ef-ac7d-c90dd478ae32
{
  "name": "read-access",
  "id": "1ec51dfd-1197-41ef-ac7d-c90dd478ae32",
  "rules": [
    "CAN getobject"
  ]
}</code></pre>
<h2>Deleting Policies</h2>
<p>Use <code>sdc-policy delete</code> to delete a policy.</p>
<pre><code>$ sdc-policy delete 092d22f3-36cd-e8db-cf8d-e39f6ad14b19</code></pre></div>
<div style="clear:both"></div>
</body>

</html>
