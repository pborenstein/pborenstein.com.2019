<!DOCTYPE html>
<html lang="en">
<head>

  <title>Getting Started with Access Control: Portal</title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <link href="/assets/styles/styles.css"    rel="stylesheet" type="text/css"  />
  <link href="/assets/styles/docstyles.css" rel="stylesheet" type="text/css" />
  <link href="/assets/styles/prettify.css"  rel="stylesheet" type="text/css" />
  <script src="/assets/js/prettify.js" type="text/javascript"></script>
  <script src="/assets/js/prettify.js" type="text/javascript"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js" type="text/javascript"></script>


    <script type="text/javascript">
      $(document).ready(function() {
          $('pre').each(function() {
              var thepre = $(this);
              if (thepre.hasClass('javascript') ||
                  thepre.hasClass('js') ||
                  thepre.hasClass('shell') ||
                  thepre.hasClass('bash')
                 )
                thepre.addClass('prettyprint');
          });
          prettyPrint();
      });
    </script>



</head>

<body>

  <div id="header">
      <div style="margin: 10px 10px">
        <p>
          Philip Borenstein: Writing sample <br/>
          This is a snapshot of this topic when I wrote it.<br/>
          You can find the current version in the
          <a href="http://docs.joyent.com">Joyent documentation.</p>
        </p>
      </div>
  </div>
  <div id="sidebar">
    <div class="menu">
      <form id="search" action="/search"><input type="search" name="q" placeholder="Search..."></form>

<ul>



	<li class="depth-1">

	<a href="/rbac">Role Based Access Control</a>


<ul>



	<li class="depth-2 hasChildren">

	<a href="/rbac/quickstart">Getting Started with Access Control: CLI</a>


	</li>


	<li class="depth-2">

	<a class="active" href="/rbac/portal">Getting Started with Access Control: Portal</a>


<ul>



</ul>

	</li>


	<li class="depth-2">

	<a href="/rbac/cloudapi">Using Access Control with CloudAPI</a>


	</li>


	<li class="depth-2">

	<a href="/rbac/users">Working with Users</a>


	</li>


	<li class="depth-2">

	<a href="/rbac/roles">Working with Roles</a>


	</li>


	<li class="depth-2">

	<a href="/rbac/policies">Working with Policies</a>


	</li>


	<li class="depth-2">

	<a href="/rbac/rules">Working with Rules</a>


	</li>


	<li class="depth-2">

	<a href="/rbac/underthehood">Under the Hood</a>


	</li>


</ul>

	</li>


</ul>
    </div>
        <div class="footblock">
    <p>Â© 2015 <a href="http://joyent.com">Joyent, Inc.</a> | <a href="mailto:&#115;&#x75;&#112;&#x70;&#111;&#x72;&#x74;&#64;&#106;&#x6f;&#x79;&#101;&#110;&#x74;&#46;&#99;&#111;&#109;">Questions, comments, feeback.</a></p></div>
  </div>
<div id="content" class="content">
    <nav class="breadcrumb">
	<ul>
					<li><a href="/">Home &rsaquo;</a></li>
					<li><a href="/rbac">Role Based Access Control &rsaquo;</a></li>
			</ul>
</nav>    <h1>Getting Started with Access Control: Portal</h1>
    <div class="infoblock">

    <div class="stability_2 stability">
        Stability: <a href="/stability">Beta</a>
    </div>
    </div>
    <p>Role Based Access Control (RBAC) lets you
provide limited access to your Joyent Cloud account
and Manta storage to other members of your organization.</p>
<p>If you haven't already,
be sure to read
the <a href="/rbac">RBAC overview</a>,
then come back here to continue.
Note that the command line interface is more
flexible that the portal interface,
and there are RBAC actions that are
<a href="#differencesbetweenportalandcli">not available in the portal</a>.</p>
<p>In this walkthrough,
we'll use the Joyent Portal to</p>
<ul>
<li>create a subuser</li>
<li>create a role that allows the subuser to log in to the portal</li>
<li>create a minimal policy</li>
</ul>
<p>Since we're starting with a blank slate,
no subusers, no roles, no policies,
it's easier to build each of these components
from the bottom up.
So we'll start by creating a policy,
creating a role that uses that policy,
the finally creating a user who assumes that role.</p>
<h2>Creating the Login Policy</h2>
<p>First, we'll create a policy that allows a subuser
to log in to the portal and
to update their user information and SSH keys</p>
<figure><img src="create-policy.png" alt="create-policy" width="60%"></figure>
<ol>
<li>Click <strong>Accounts</strong> in the left navigation pane.</li>
<li>Click <strong>Policies</strong>.</li>
<li>Click <strong>Create Policy</strong> in the upper right corner.</li>
<li>Name the policy &quot;Login&quot;.</li>
<li>
<p>Add the following rules.
Make sure that you spell the actions like <code>getuser</code> correctly.
Rules are case sensitive.
The capitalized <code>CAN</code> is a convention.</p>
<ul>
<li>CAN changeuserpassword</li>
<li>CAN createuserkey</li>
<li>CAN deleteuserkey</li>
<li>CAN getuser</li>
<li>CAN listuserkeys</li>
<li>CAN updateuser</li>
</ul>
<p>You can enter the rules separated by commas
in a single line:</p>
<pre><code>CAN changeuserpassword, CAN createuserkey, ..., and CAN updateuser</code></pre>
</li>
<li>Click <strong>Create Policy</strong> to create the policy.</li>
<li>The policy &quot;Login&quot; will appear in the list of policies.</li>
</ol>
<p>You can learn more about policies in
<a href="/rbac/policies">Working with Policies</a>,
and you can learn about the available rules in
<a href="/rbac/rules">Working with Rules</a>.</p>
<h2>Creating the Basic User Role</h2>
<p>Next, we'll create a role named &quot;Basic User&quot;
that uses the &quot;Login&quot; policy.</p>
<figure><img src="create-role.png" alt="create-role" width="60%"></figure>
<ol>
<li>Click <strong>Roles</strong> in the left navigation pane.</li>
<li>Click <strong>Create Role</strong> in the upper right corner.</li>
<li>Create a role named &quot;Basic User&quot;.</li>
<li>Expand the list of policies by clicking on the <code>+</code>.
You should see the &quot;Login&quot; policy you created earlier.</li>
<li>Check the &quot;Login&quot; policy to make it part of the role.</li>
<li>Click <strong>Create Role</strong> to create the role.</li>
<li>The role &quot;Basic User&quot; will appear in the list of roles.</li>
</ol>
<p>A role must have a name.
You can create a role without policies or users.</p>
<p>You can learn more about roles in
<a href="/rbac/roles">Working with Roles</a>.</p>
<h2>Creating the User</h2>
<p>Now, we'll create a user
and assign them the &quot;Basic User&quot; role.</p>
<figure><img src="create-user.png" alt="create-user" width="60%"></figure>
<ol>
<li>Click <strong>Users</strong> in the left navigation pane.</li>
<li>Click <strong>Create User</strong> in the upper right.</li>
<li>
<p>Fill out the form.
Some of the fields will be filled with data from the main account.
You must provide at least the following fields:</p>
<ul>
<li>Username</li>
<li>Email Address</li>
<li>Password</li>
<li>Country</li>
</ul>
</li>
<li>You'll see the &quot;Basic Role&quot; you created earlier
in the list of available roles.
Click it to move it to the list of assigned roles.</li>
<li>Click <strong>Create User</strong> at the bottom of the form.</li>
</ol>
<p>The subuser will appear in the list of users.</p>
<p>You can learn more about users in
<a href="/rbac/users">Working with Users</a>.</p>
<h2>Logging In as a Subuser</h2>
<p>You may want to do this part in a different browser
than the one you used to create the user.
Otherwise log out of your Joyent Cloud account.</p>
<p>To log in as a subuser, append '/subusername'
to the account owner's accountname,
and use the subuser's password.
For example, if your Joyent Cloud account name
is <code>coffeeco</code> and the subuser's username is <code>opal</code>,
you would log in as <code>coffeeco/opal</code>.</p>
<p>If you followed the steps above,
you should be able to log in as the subuser.
In this walkthrough we created a role
that uses a policy that provides the minimum
permissions for a subuser to log in.
The subuser can view and modify their own information,
such as changing the password,
but nothing else.
The subuser will not be
able to list or create instances,
work with Manta storage,
or create other users.</p>
<p>If a subuser doesn't have any roles that allow them to log in,
they'll be redirected to an &quot;Access Denied&quot; page.</p>
<p>If a subuser forgets their password,
they can use the reset password link,
and use <code>&lt;account&gt;/&lt;subuser&gt;</code> in the user name field.</p>
<p>In the next section
we'll add policies that allow more actions
and create roles that use those policies.</p>
<h2>Adding More Roles and Policies</h2>
<p>The &quot;Basic User&quot; role is very limited.
It doesn't allow the subuser to do anything useful.
In this section we'll create some new roles
and the policies to go with them.</p>
<h3>Adding a Support Role</h3>
<p>Suppose we want people in our support department
to be able to see all instances in the account,
start and stop them,
but not be able to create new instances.
We already have the &quot;Login&quot; policy
that allows subusers to log in to the portal.
Now let's add policies that allow
starting and stopping instances,
and listing them.</p>
<p>The first policy is &quot;Listing&quot;.
It allows listing of anything in the datacenter.</p>
<ul>
<li>CAN getaccount</li>
<li>CAN getnetwork</li>
<li>CAN listdatacenters</li>
<li>CAN listmachines</li>
<li>CAN listpackages</li>
<li>CAN listnetworks</li>
<li>CAN listimages</li>
<li>CAN listfirewallrules</li>
</ul>
<p><strong>Note</strong><br/>
The <code>getaccount</code> and <code>getnetwork</code> actions are needed
in order to allow listing in the portal.</p>
<p>The next policy is &quot;Reboot&quot;.
It allows starting, stopping, and rebooting instances.</p>
<ul>
<li>CAN startmachine</li>
<li>CAN stopmachine</li>
<li>CAN rebootmachine</li>
<li>CAN getmachine</li>
</ul>
<p><strong>Note</strong><br/>
The <code>getmachine</code> action is needed
in order to allow the portal to get
the current state of an instance.</p>
<p>Now we'll create a &quot;Support&quot; role
that uses all the policies we've created,
and assign that role to a user.</p>
<figure><img src="support-role.png" alt="support-role" width="60%"></figure>
<h3>Adding an Operator Role</h3>
<p>We want some of our subusers to be able
to create instances.
We'll create a new policy called &quot;Creating&quot;
and a new role called &quot;Operator&quot;.</p>
<p>The &quot;Creating&quot; policy looks like this.</p>
<ul>
<li>CAN createmachine</li>
<li>CAN deletemachine</li>
<li>CAN getmachine</li>
<li>CAN listkeys</li>
</ul>
<p><strong>Note</strong><br/>
The <code>listkeys</code> action is needed
by the portal.</p>
<p>The &quot;Operator&quot; role uses all of the policies we've defined.</p>
<figure><img src="operator-role.png" alt="operator-role" width="60%"></figure>
<h2 id="differencesbetweenportalandcli">Differences Between Portal and CLI</h2>
<p>There are some things that you can do
with the RBAC command line interface
that you cannot do in the portal.</p>
<ul>
<li>You cannot assign the
<a href="/rbac/roles#theadministratorrole">administrator</a> role
to a user.</li>
<li>You cannot create the <a href="/rbac/users#theanonymoususer">anonymous user</a>.</li>
<li>You cannot assign the anonymous user to a role.</li>
<li>When a user is assigned a role, the user is added to both the
<a href="/rbac/roles#memberlistsanddefaultroles">default members list</a>
and the members list.</li>
<li>Users cannot assume roles if they are not in the default members list.</li>
<li>The portal interface automatically associates roles
with every resource in the account.</li>
</ul></div>
<div style="clear:both"></div>
</body>

</html>
