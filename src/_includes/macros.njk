{%-macro articlesList(aList) -%}
<div class="articleList">
  {%-for article in aList | reverse -%}
    {% set text %}{{article.templateContent|safe|truncate(48) }}{% endset %}
    {{ card(article.url,
            article.data.title,
            text,
            article.data.category,
            article.data.tags,
            timeTag(article.date, ""))}}
  {%-endfor -%}
</div>
{% endmacro %}

{% macro timeTag(theDate, theClass) %}
  <span {% if theClass -%}class="{{- theClass -}}"{%-endif -%}><time
        datetime="{{ theDate | htmlDateString }}">
    {{ theDate | readableDate }}
  </time></span>
{%endmacro %}


{# sort(reverse, caseSens) #}

{%- macro taglist(theTags) -%}
  {%- for tag in theTags | sort(false, true) %}
    {%- if tag.substring(0,1) !== "_" -%}
    {%- set tagUrl %}/tags/{{ tag }}/{%- endset -%}
    <a href="{{ tagUrl | url }}" class="atag"><span>{{ tag }}</span></a> <!-- -->
    {%- endif -%}
  {%- endfor %}
{%- endmacro -%}


{%-macro card(url, title, subhead, category, tags, time) -%}
<div class="card">
  <div class="card-title">
  {%-if title -%}
    <a href="{{ url | url }}">
      <span>
        {%-if title -%}
          {{ title }}
        {%-else -%}
          <code>{{ url }}</code>
        {%-endif -%}
      </span>
    </a>
  {%-endif -%}
  </div>
  <div class="card-subhead">
    <a href="{{ url | url }}">
    <span class="card-line">
      {{ subhead | safe }}
    </span>
    </a>
  </div>
  <div class="card-category">
    {%- if category %}
      <a class="category" title="{{category}}" href="/categories/{{category}}">
        {{- category.substring(0,2) -}}
      </a>
    {% endif %}
  </div>
  <div class="card-tags">&#8203;
    {{- taglist(tags) -}}
  </div>
  <div class="card-date">{{ time }}</div>
</div>
{% endmacro %}
